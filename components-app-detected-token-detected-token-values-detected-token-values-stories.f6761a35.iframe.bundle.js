"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[2518],{"./ui/components/app/detected-token/detected-token-values/detected-token-values.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _DefaultStory_parameters,_DefaultStory_parameters_docs,_DefaultStory_parameters1,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_detected_token_values__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ui/components/app/detected-token/detected-token-values/detected-token-values.js");function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))),ownKeys.forEach(function(key){_define_property(target,key,source[key])})}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}),target}let __WEBPACK_DEFAULT_EXPORT__={title:"Components/App/DetectedToken/DetectedTokenValues",argTypes:{token:{control:"object"},handleTokenSelection:{control:"func"},tokensListDetected:{control:"array"}},args:{token:{address:"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f",symbol:"SNX",decimals:18,iconUrl:"https://assets.coingecko.com/coins/images/3406/large/SNX.png",aggregators:["aave","bancor","cmc","cryptocom","coinGecko","oneInch","paraswap","pmm","synthetix","zapper","zerion","zeroEx"]},tokensListDetected:{"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f":{token:{name:"Synthetix Network",address:"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f",symbol:"SNX",decimals:18,iconUrl:"https://assets.coingecko.com/coins/images/3406/large/SNX.png",aggregators:["aave","bancor","cmc","cryptocom","coinGecko","oneInch","paraswap","pmm","synthetix","zapper","zerion","zeroEx"]},selected:!0},"0x514910771af9ca656af840dff83e8264ecf986ca":{token:{name:"ChainLink Token",address:"0x514910771af9ca656af840dff83e8264ecf986ca",symbol:"LINK",decimals:18,iconUrl:"https://crypto.com/price/coin-data/icon/LINK/color_icon.png",aggregators:["coinGecko","oneInch","paraswap","zapper","zerion"]},selected:!0}}}};var DefaultStory=(function(args){return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_detected_token_values__WEBPACK_IMPORTED_MODULE_1__.Z,args)}).bind({});DefaultStory.storyName="Default",DefaultStory.parameters=_object_spread_props(_object_spread({},DefaultStory.parameters),{docs:_object_spread_props(_object_spread({},null===(_DefaultStory_parameters=DefaultStory.parameters)||void 0===_DefaultStory_parameters?void 0:_DefaultStory_parameters.docs),{source:_object_spread({originalSource:"args => {\n  return <DetectedTokenValues {...args} />;\n}"},null===(_DefaultStory_parameters1=DefaultStory.parameters)||void 0===_DefaultStory_parameters1?void 0:null===(_DefaultStory_parameters_docs=_DefaultStory_parameters1.docs)||void 0===_DefaultStory_parameters_docs?void 0:_DefaultStory_parameters_docs.source)})})},"./ui/components/app/detected-token/detected-token-values/detected-token-values.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_hooks_useTokenTracker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/hooks/useTokenTracker.js"),_hooks_useTokenFiatAmount__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/hooks/useTokenFiatAmount.js"),_selectors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/selectors/index.js"),_component_library__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/component-library/index.ts");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _array_with_holes(arr){if(Array.isArray(arr))return arr}function _iterable_to_array_limit(arr,i){var _s,_e,_i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _sliced_to_array(arr,i){return _array_with_holes(arr)||_iterable_to_array_limit(arr,i)||_unsupported_iterable_to_array(arr,i)||_non_iterable_rest()}function _unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}}var DetectedTokenValues=function(param){var _tokensWithBalances_,token=param.token,handleTokenSelection=param.handleTokenSelection,tokensListDetected=param.tokensListDetected,_useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(function(){var _tokensListDetected_token_address;return null===(_tokensListDetected_token_address=tokensListDetected[token.address])||void 0===_tokensListDetected_token_address?void 0:_tokensListDetected_token_address.selected}),2),tokenSelection=_useState[0],setTokenSelection=_useState[1],balanceString=null===(_tokensWithBalances_=(0,_hooks_useTokenTracker__WEBPACK_IMPORTED_MODULE_3__.S)({tokens:[token]}).tokensWithBalances[0])||void 0===_tokensWithBalances_?void 0:_tokensWithBalances_.string,formattedFiatBalance=(0,_hooks_useTokenFiatAmount__WEBPACK_IMPORTED_MODULE_4__.Q)(token.address,balanceString,token.symbol),useCurrencyRateCheck=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_5__.nsI);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){var _tokensListDetected_token_address;setTokenSelection(null===(_tokensListDetected_token_address=tokensListDetected[token.address])||void 0===_tokensListDetected_token_address?void 0:_tokensListDetected_token_address.selected)},[tokensListDetected,token.address,tokenSelection,setTokenSelection]),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xu,{display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.sS.InlineFlex,className:"detected-token-values"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xu,{marginBottom:1},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.rK.bodyLgMedium,as:"h4"},"".concat(balanceString||"0"," ").concat(token.symbol)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.rK.bodySm,as:"h6",color:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.d9.textAlternative},useCurrencyRateCheck?formattedFiatBalance||"$0":formattedFiatBalance)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xu,{className:"detected-token-values__checkbox"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.XZ,{isChecked:tokenSelection,onClick:function(){setTokenSelection(!tokenSelection),handleTokenSelection(token)}})))};DetectedTokenValues.propTypes={token:prop_types__WEBPACK_IMPORTED_MODULE_7___default().shape({address:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string.isRequired,decimals:prop_types__WEBPACK_IMPORTED_MODULE_7___default().number,symbol:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,iconUrl:prop_types__WEBPACK_IMPORTED_MODULE_7___default().string,aggregators:prop_types__WEBPACK_IMPORTED_MODULE_7___default().array}),handleTokenSelection:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func.isRequired,tokensListDetected:prop_types__WEBPACK_IMPORTED_MODULE_7___default().object};let __WEBPACK_DEFAULT_EXPORT__=DetectedTokenValues},"./ui/hooks/useEqualityCheck.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>useEqualityCheck});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/lodash.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _array_with_holes(arr){if(Array.isArray(arr))return arr}function _iterable_to_array_limit(arr,i){var _s,_e,_i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _sliced_to_array(arr,i){return _array_with_holes(arr)||_iterable_to_array_limit(arr,i)||_unsupported_iterable_to_array(arr,i)||_non_iterable_rest()}function _unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}}function useEqualityCheck(value){var equalityFn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual,_useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(value),2),computedValue=_useState[0],setComputedValue=_useState[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(function(){equalityFn(value,computedValue)||setComputedValue(value)},[value,equalityFn,computedValue]),computedValue}},"./ui/hooks/useTokenFiatAmount.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>useTokenFiatAmount});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_selectors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/selectors/index.js"),_helpers_utils_token_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/helpers/utils/token-util.js"),_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/ducks/metamask/metamask.js"),_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/modules/string-utils.ts");function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))),ownKeys.forEach(function(key){_define_property(target,key,source[key])})}return target}function useTokenFiatAmount(tokenAddress,tokenAmount,tokenSymbol){var _overrides_showFiat,_overrides_exchangeRate,overrides=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},hideCurrencySymbol=arguments.length>4?arguments[4]:void 0,mergedRates=_object_spread({},(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.fPF,react_redux__WEBPACK_IMPORTED_MODULE_1__.wU),(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.$a4)),conversionRate=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__.PC),currentCurrency=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.TV3),userPrefersShownFiat=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.i8I),showFiat=null!==(_overrides_showFiat=overrides.showFiat)&&void 0!==_overrides_showFiat?_overrides_showFiat:userPrefersShownFiat,contractExchangeTokenKey=Object.keys(mergedRates).find(function(key){return(0,_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_5__.J)(key,tokenAddress)}),tokenExchangeRate=null!==(_overrides_exchangeRate=overrides.exchangeRate)&&void 0!==_overrides_exchangeRate?_overrides_exchangeRate:contractExchangeTokenKey&&mergedRates[contractExchangeTokenKey],formattedFiat=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(function(){return(0,_helpers_utils_token_util__WEBPACK_IMPORTED_MODULE_3__.Hr)(tokenExchangeRate,conversionRate,currentCurrency,tokenAmount,tokenSymbol,!0,hideCurrencySymbol)},[tokenExchangeRate,conversionRate,currentCurrency,tokenAmount,tokenSymbol,hideCurrencySymbol]);if(showFiat&&currentCurrency.toUpperCase()!==tokenSymbol)return formattedFiat}},"./ui/hooks/useTokenTracker.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>useTokenTracker});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@metamask/eth-token-tracker/dist/index.js"),_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1__),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/selectors/index.js"),_shared_constants_time__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/constants/time.ts"),_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/modules/string-utils.ts"),_useEqualityCheck__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/hooks/useEqualityCheck.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _array_with_holes(arr){if(Array.isArray(arr))return arr}function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _iterable_to_array_limit(arr,i){var _s,_e,_i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))),ownKeys.forEach(function(key){_define_property(target,key,source[key])})}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}),target}function _sliced_to_array(arr,i){return _array_with_holes(arr)||_iterable_to_array_limit(arr,i)||_unsupported_iterable_to_array(arr,i)||_non_iterable_rest()}function _unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}}function useTokenTracker(param){var tokens=param.tokens,address=param.address,_param_includeFailedTokens=param.includeFailedTokens,includeFailedTokens=void 0!==_param_includeFailedTokens&&_param_includeFailedTokens,_param_hideZeroBalanceTokens=param.hideZeroBalanceTokens,hideZeroBalanceTokens=void 0!==_param_hideZeroBalanceTokens&&_param_hideZeroBalanceTokens,chainId=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_3__.BVZ),selectedAddress=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_3__.E7u,react_redux__WEBPACK_IMPORTED_MODULE_2__.wU).address,userAddress=null!=address?address:selectedAddress,_useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(function(){return(null==tokens?void 0:tokens.length)>=0}),2),loading=_useState[0],setLoading=_useState[1],_useState1=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),2),tokensWithBalances=_useState1[0],setTokensWithBalances=_useState1[1],_useState2=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),error=_useState2[0],setError=_useState2[1],tokenTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),memoizedTokens=(0,_useEqualityCheck__WEBPACK_IMPORTED_MODULE_5__.F)(tokens),updateBalances=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(function(tokenWithBalances){setTokensWithBalances((hideZeroBalanceTokens?tokenWithBalances.filter(function(token){return Number(token.balance)>0}):tokenWithBalances).map(function(token){var additionalTokenData=memoizedTokens.find(function(t){return(0,_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_6__.J)(t.address,token.address)});return _object_spread_props(_object_spread({},token),{isERC721:null==additionalTokenData?void 0:additionalTokenData.isERC721,image:null==additionalTokenData?void 0:additionalTokenData.image})})),setLoading(!1),setError(null)},[hideZeroBalanceTokens,memoizedTokens]),showError=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(function(err){setError(err),setLoading(!1)},[]),teardownTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(function(){tokenTracker.current&&(tokenTracker.current.stop(),tokenTracker.current.removeAllListeners("update"),tokenTracker.current.removeAllListeners("error"),tokenTracker.current=null)},[]),buildTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(function(usersAddress,tokenList){teardownTracker(),tokenTracker.current=new(_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1___default())({userAddress:usersAddress,provider:__webpack_require__.g.ethereumProvider,tokens:tokenList,includeFailedTokens:includeFailedTokens,pollingInterval:8*_shared_constants_time__WEBPACK_IMPORTED_MODULE_4__.sh,balanceDecimals:5}),tokenTracker.current.on("update",updateBalances),tokenTracker.current.on("error",showError),tokenTracker.current.updateBalances()},[updateBalances,includeFailedTokens,showError,teardownTracker]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){return teardownTracker},[teardownTracker]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function(){if(setLoading(!0),!userAddress||void 0===chainId||!__webpack_require__.g.ethereumProvider){teardownTracker();return}0===memoizedTokens.length&&updateBalances([]),buildTracker(userAddress,memoizedTokens)},[userAddress,teardownTracker,chainId,memoizedTokens,updateBalances,buildTracker]),{loading:loading,tokensWithBalances:tokensWithBalances,error:error}}}}]);